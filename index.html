<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>upload</title>
</head>
<body>
  <h1>名前で保存する</h1>
  <p>d6 リソースシートb3 完了以外を表示</p>
  <p>新しい情報です</p>
<pre>
  <code>
===================COBOL===================
拡張子…cob
【コメント】
固定書式…7番目(一連番号の直後)に*　※8～11 A領域　12～B領域（コボルのプログラム領域）
自由書式…*>
【文末】
．_ ※_は空白
配列のインデックス番号は1から始まる
文字列の連結…半角スペース

↓プログラムの記述形式
【固定形式】
左から1～6列は記述不可
左7列はコメント（*）を記述する
8列からプログラムを記述していく
　∟_______*DIVISION....みたいな※_は6スペース確保している
【自由形式】
どこから書いてもいいが、コメントが違う
　∟*>

【OPEN】
【CLOSE】
【READ】
【WRITE】
　∟WRITE 出力領域 FROM 編集領域
【MOVE】
　∟代入 MOVE 変数　TO 変数2 ※変数の値を変数2に代入する
　∟桁数が小さい場合…数字は小数点が右にあるとされて、上位が切り捨てられる
	…文字は先頭から埋められて、下位がきりすてられる
【COMPUTE】
　∟計算する場合に記述
　∟例 COMPUTE W-TOTAL = U-JUCE + U-TEA + U-COFFEE.※変数 ROUNDED←変数のデータに併せて、四捨五入する。記述なしは切り捨て
※桁あふれ（オーバーフロー）による処理分岐
COMPUTE W-TOTAL = U-JUCE + U-TEA + U-COFFEE
	ON SIZE ERROR
		桁あふれの場合の処理
	NOT ON SIZE ERROR
		桁あふれでない場合の処理
END-COMPUTE.

【STOP】
　∟プログラム終了
　∟例 STOP RUN.


【領域】
入力領域…入力してきたレコード値を保存する領域
出力領域…出力するレコード値を保存する領域
作業領域…編集・加工項目を保存する領域
編集領域…プリントレイアウトを記憶する


レベル番号 ※01～49が可能範囲
レコード名は01
各カラムを02
01が一番上位の階層になる。番号によって　階層関係になる
※レコード名のような全体を集団項目・各カラムのような最小単位を基本項目



DIVISION　>　SECTION
DIVISION…順番必須だが、省略可能
【見出し部】
 ∟①IDENTIFICATION DIVISION.←記述必須　プログラムID
　　 	PROGRAM-ID. 任意の文字列(プログラム名).

【環境部】
環境部（実行環境・入出力ファイル等を記述）書き込み
 ∟②ENVIRONMENT DIVISION.←省略可能
　　 INPUT-OUTPUT SECTION.
     FILE-CONTROL.　　←どのファイルに書き込むか
	 SELECT OUT-FILE※A ASSIGN TO 'ファイル名(例out.txt)'
　　　　 		ORGANIZATION IS LINE SEQUETIAL.　改行で書き込む指定する
※環境部の例
　SELECT URIAGE_F（※ファイル名） ASSIGN TO DISK.
  SELECT PRINT_F  ASSIGN TO PRINTER.


環境部（実行環境・入出力ファイル等を記述）読み込み
 ∟②ENVIRONMENT DIVISION.←省略可能
　　　　INPUT-OUTPUT SECTION.
	  	FILE-CONTROL.　　←どのファイルに書き込むか
	    	SELECT IN-FILE※A ASSIGN TO 'ファイル名(例in.txt)'
　　　　　　  	ORGANIZATION IS LINE SEQUETIAL.　改行で書き込む指定する
	      	STATUS 変数名B.←ステータスを管理するための変数を定義
→③データ部に定義DATA DIVISION.
		  01 変数名B


【データ部】
データ部（変数の定義等を行うエリア）
 ∟③DATA DIVISION.←省略可能
記述例）
DATA DIVISION.
　　FILE SECTION.←ファイル節（入出力で利用する領域の定義）
	FD ファイル名.　※ファイル名は環境部と同じファイル名
	レコード記述項.
  　WOUKING-STORAGE SECTION.←作業場所節。（入出力以外で利用する領域の定義）※初期値を設定できるVALUE句が利用できる
    	01 変数名 PIC X(20).
	∟変数のレベル番号・変数名・PIC・
	∟文字列はX(文字数）又はXを文字数分記述
	∟代入は手続き部エリアにて実施
　　	01 変数名 PIC 9(桁数) ※VALUE デフォルト値.
	∟数値は9(桁数)　又は9を文字数分記述　整数値　マイナスを含む場合はS9(桁数)
	∟0埋めされる
	∟デフォルト値はなくても良い

    	01 変数名 PIC 9(桁数)V9(小数点の桁数). 又は9999V99
	∟小数点はVを付与して記述する

　　	01 FILLER PIC X(20). ←文字列20数分の予備領域確保
		


 	環境部の指定時↓書き込み
　　　　　FILE SECTION. ←ファイルセクションを定義する
            FD OUT-FILE※A.
	     01 変数名 PIC 99.
	  WORKING-STORAGE SECTION.
	    01 変数名 PIC 99 VALUE 0.

	環境部の指定時↓読み込み
　　　　　FILE SECTION. ←ファイルセクションを定義する
            FD IN-FILE※A.
	     01 変数名 PIC X(20).
	  WORKING-STORAGE SECTION.
例
FD URIAGE_F.※入力レコードの領域
　O1 URIAGE_REC.
	02 U-NAME   PIC X(10).
	02 U-JUICE  PIC 9(06).
FD PRINT_F.※出力レコードの領域
　O1 PRINT_REC.
	02 P-NAME   PIC X(10).
	02 P-JUICE  PIC 9(06).
WOUKING-STORAGE SECTION.←作業場所節
  O1 MEISAI_REC.
	02 FILLER PIC X(04) VALUE SPACE.※VALUEは作業場所節のみで使用可能　SPACEはスペースで4範囲格納
	02 P-NAME PIX X(10)←レコードの最小単位の名前
	※FILLER…無記名項目という名前が不要な項目
SPACE　一つ以上の空白
ZERO　　一つ以上の0
HIGH-VALUE 
LOW-VALUE




集合項目（※レベル番号は親子関係を表す）
　01 変数名A.
    03 変数名B PIC X(10).
    03 変数名C PIC 9(100).
 ∟使い方は手続き部にて記述

配列
　01 配列名AA.
    03 配列名BB OCCURS 3 PIC X(90). ※OCCURS 領域数


【表（配列）】
インデックスは1から
データ部
　∟FD 読み込みファイル名.
	01 URIAGE-REC.
		02 U-NAME PIC X(10).　←入力領域は各カラムの値
		02 U-JUICE PIC 9(06) OCCURS 要素数.  ※　VALUES 0.　初期値も付与可能
※
作業領域にインデックスの変数を作成することを忘れない
添え字の定義←データ部での定義※注意
※インデックスの添え字の桁数　PIC 9(01)1～9 / PIC 9(02) 10～99 / PIC 9(03) 100～999


【配列の繰り返し】
外パフォーム文
PERFORM 呼び出し先 VARYING インデックス変数  FROM 初期値 BY 増減値 UNTIL 条件（満たすまで実行する）


内パフォーム文
PERFORM VARYING インデックス変数 FROM 初期値 BY 増減値 UNTIL 条件（満たすまで実行する）
処理
END-PERFORM.

VARYING…データの値を変えながら繰り返し処理を実行してくれる

例　インデックスが1～3の間繰り返しを行う
　∟PERFORM VARYING IND FROM 1 BY 1 UNTIL IND > 3
	COMPUTE W-TOTAL = W-TOTAL + U-DRINK(IND)
    END-PERFORM.



【データ部のデータの再定義】
　02 再定義する変数名 REDEFINES 既存変数名.※レベル番号は同じに刷ること
例
01 CHECK-VALUE.
  02 FILLER PIC X(08) VALUE "0040000A".←40000(点数) と　A（判定）の内容が定義されている
  02 FILLER PIC X(08) VALUE "0030000B".
01 CHECK-HYO-R REDEFINES CHECK-VALUE.←CHECK-VALUEを再定義する
  02 CHECK-HYO OCCURS 2.
	03 W-CHECK PIC 9(7).
	03 W-CHECK PIC X(1).

※集団項目(親)はXタイプとなるので子が9(1)整数でも計算には利用できない!
01 W-DATE.
  02 W-YEAR PIC 9(4) VALUE 2024.
  02 W-MONTH PIC 9(2) VALUE 12.
01 W-DATE-R REDEFINES W-DATE PIC 9(6).←再定義することで整数型になり、計算で利用できるようになる

【手続き部】
手続き部
 ∟④PROCEDURE DIVISION.←記述必須
       MAIN SECTION.※節名称 SECTION
	MOVE 文字列 TO 変数名.←変数名に代入する
	DISPLAY 変数名.
	*>集合項目↓
	MOVE 文字列B TO 変数名B.←集合項目代入
	MOVE 文字列C TO 変数名C.←集合項目代入
	DISPLAY 変数名A         ←変数名B,Cを出力する
	DISPLAY 変数名C         ←変数名Cのみ出力する
	*>配列↓
	MOVE 文字列BB TO 配列名BB(1).
	STOP RUN.※節名称の終了

指示の内容
OPEN INPUT ファイル名A　　　←入力用
     OUTPUT ファイル名B.※.は一つ←出力用
READ ファイル名A.　←データ部のファイル名 1レコードの処理を記述できる
	AT END データ終了時の処理
	NOT AT END データ存在時の処理
END-READ.

出力処理
WRITE レコード名.←データ部のレコード名
※ WRITE レコード名 FROM 編集領域.　※AFTER PAGE.←改行(改ページ後) AFTER 2.←飛ばし改行


DISPLAY 表示させる指示

CLOSE ファイル名A  ファイルを閉じる
      ファイル名B.
STOP RUN.　プログラム終了

【代入】
MOVE 変数1 TO 変数2.

MOVE 変数1 TO 変数2
              変数3.※変数1を２，３に代入する

※桁数の違い
小数点の位置に合わせて上位が切り捨てられる
0埋め

文字は下位が切り捨て
空白埋め


【データの編集】
目的…データを見やすくする
データ編集前→06000   データ編集後→  6,000
手順　データ部を変更する
　∟02 変数名 PIC ZZZ,ZZ9.※1の位を数字として空白を避ける
※
英数字　X
数字　9,S,V（仮想小数点）
数字編集 Z,, . \ + - ←計算には使用できない
　∟Z(0を抑制),(,を入力).(小数点を入力)\(数字の左側に\記号)-+（数字の左側に入力）
※前に数字のない,は空白扱いになる
注意
　∟123456 \\\,\\9 →\23,456上位が欠落する!!
計算に利用する小数点←作業領域
　∟02 変数名 PIC 999V99.　→　作業領域から編集領域へ 02 変数名 PIC 999.99. 
注意
　∟小数点のカット 02 変数名 PIC 999V99. 12345 （123.45と同一）→　02 変数名 PIC 99999    00123になってしまう

12345 →　PIC +++++9 → +12345※プラスが明示される
-12345 → PIC +++++9 → -12345
12345 → PIC -----9 → 12345※プラスの場合は空白扱いになる
※\,+- 桁を多く取らないと　桁数切り捨てになってしまうので注意する
例-12345 > ----9 > -2345

★計算
データ部
DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 NUM-1
	03 D1 PIC 9(5) VALUE 0.
	03 D2 PIC 9(5) VALUE 0.
	03 D3 PIC 9(5) VALUE 0.
	03 D4 PIC 9(5) VALUE 0.

手続き部
足し算
　∟ADD 5 TO D1. ←D1+5
　∟ADD 6 TO D1 D3 D4. ←D1+5　D3+5　D4+5
引き算
　∟SUBTRACT 4 FROM D1. ←D1-4
割り算
　∟DIVIDE D1 BY D2 GIVING D3 REMAINDER D4, ←D1/D2 D3に答え代入（GIVING） D4に余り代入（REMAINDER）
かけ算
　∟MULTIPLY D1 BY D2 GIVING D3 ←D1*D2 D3に答え代入（GIVING）

その他の処理
　∟COMPUTE D3 = D1 * D2. ←かけ算と同じ処理を実施　＋－／＊　**

COMPUTE 変数 = へんすう + HENNSUU / HENNSUU3 * 5.※間に半角空白が必要
COMPUTE へんすう ROUNDED = ※少数第一を四捨五入する　ないと切り捨て

オーバーフローの対応
　COMPUTE へんすう　＝
	ON SIZE ERROR
		オーバーフロー時の処理
	NOT ON SIZE ERROR
 		じゃないときの処理
END-COMPUTE.


★インプットボックス
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名V PIC X(80).
 
手続き部
  DISPLAY 質問？.
  ACCEPT 変数名V.


①
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名N PIC 9(2).

手続き部
【条件分岐1　2分岐処理】
 IF 変数名N > 60
	THEN
  		TRUEの処理※CONTINUEの記述が可能
 	ELSE
　		FALSEの処理※省略可能
 END-IF.※END-IFの後にのみ.を記述する

 ※　ELSE CONTINUE…何もしないで次の処理に移動。書かなくても良い
※ネストは可能。ネストの場合は一番外の処理に．を記述する

【条件分岐2　多分岐処理】
IFをネストさせない書き方。条件が当てはまる1つが実行される
EVALUATE TRUE
	WHEN 条件 
		処理
	WHEN 条件
		処理
	WHEN OTHER※当てはまらないとき
		処理
END-EVALUATE.

EVALUATE データ値
	WHEN 値1 THRU 値2 ※範囲指定 値1以上値2以下と同等
		処理
	WHEN 値
		処理
	WHEN OTHER
		処理
END-EVALUATE.


【比較演算子】
・= (IS EQUAL TO)
・NOT = (IS NOT EQUAL TO)
・> (IS GREATER THEN)
・>= (IS GREATER THEN OR EQUAL TO)
・< (IS LESS THAN)
・<= (IS LESS THEN OR EQUAL TO)

【論理演算子】
AND
OR

【繰り返し】
ファイルを読み込むと内容の有無が判断できるので、繰り返しを実施する場合は
1つ目のレコード処理→繰り返し文で2つ目からの処理を実施する


データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名N PIC 9(2) VALUE 1.

内パフォーム文※モジュールに飛ばない記述のため、END-PERFORM.を記述すること!!
  PERFORM 10 TIMES  ←終了条件（まで）　10回繰り返す
    処理
    ADD 1 TO 変数名N 
  END-PERFORM.　←END-PERFORMの後にのみ.を記述する


外パフォーム文
※動き---PERFORM　モジュール > モジュール分に移動して処理を実行 > PERFORM文の次の処理に進む
PERFORM 呼び出しモジュール ※1 WITH TEST BEFORE(又は AFTER) ※2 UNTIL 条件
※1 先に判定（デフォルト値）…WITH TEST BEFORE　後に判定…WITH TEST AFTER
※2 条件は終了条件を記述すること　無限ループにならないように!!



【出力領域の不要な0抑制& カンマ付与】





②
EVALUATE
END-EVALUATEの後にのみ.を記述する
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名X PIC X(2).

手続き部
  MOVE 文字列 TO 変数名X.
  EVALUATE 変数名X
　　WHEN "AAA"
	処理AAA
    WHEN "BBB"
        処理BBB
    WHEN OTHER
        当てはまらない処理
  END-EVALUTE.


★繰り返し
END-PERFORMの後にのみ.を記述する
①
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名N PIC 9(2) VALUE 1.

手続き部
  PERFORM 10 TIMES  ←10回繰り返す
    処理
    ADD 1 TO 変数名N 
  END-PERFORM.


②
　PERFORM UNTIL 変数名N > 10  ←条件に達したら処理終了
　　処理
　　ADD 1 TO 変数名N ←無限を防ぐ
  END-PERFORM.

③
　PERFORM VARYING 変数名N FROM 1 BY 1 UNTIL 変数名N > 10
    処理
  END-PERFORM.
  ∟FROM…開始
　∟BY…づつ
　∟UNTIL…条件に達するまで


★ファイルを書き込む
　∟
手続き部 OPEN OUTPUT OUT-FILE.※A
	PERFORM 10 TIMES←ループ文
	  ADD 1 TO LINE-COUNT
	  MOVE LINE-COUNT TO 変数名※ファイルセクションを定義した変数名
	  WRITE 変数名※ファイルセクションを定義した変数名
	END-PERFORM.

	CLOSE OUT-FILE.※A
∟ファイルの確認
ターミナル画面
　　∟less ファイル名

★ファイルの読み込み
事前にin.txtが存在する前提
手続き部 OPEN INPUT IN-FILE.※A
	PERFORM UNTIL 変数名　NOT = "00"←ループ文 正常なら00が返る　変数はWORKING-STORAGEで定義した変数
	　READ IN-FILE
	    AT END　
		※データが読み終わった際の処理
 	    NOT AT END　
		※データ読み込み途中の処理
		DISPLAY 変数名※ファイルセクションを定義した際の変数
	  END-READ
	END-PERFORM.

	CLOSE IN-FILE.※A




【例題】
IDENTIFICATION DIVISION.
PROGRAM-ID. プログラム名.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.　　
	 SELECT 読み込みファイル名 ASSIGN TO DISK.
         SELECT 書き込みファイル名 ASSIGN TO PRINTER.	

DATA DIVISION.
FILE SECTION.←ファイル節
FD 読み込みファイル名.
01 URIAGE-REC.
	02 U-NAME PIC X(10).　←入力領域は各カラムの値
	02 U-JUICE PIC 9(06).
	02 U-TEA PIC 9(06).
	02 U-COFFEE PIC 9(06).
FD 書き込みファイル名.   ←出力領域は全ての結果を羅列　____XXXXXXXXXX___XXXXXX___XXXXXX___XXXXXX___X
01 PRINT-REC PIC X(60).

WOUKING-STORAGE SECTION.←作業場所節。作業領域を記述
01 MEISAI-REC.
	02 FILTER PIC X(04) VALUE SPACE.　←編集領域
	02 P-NAME PIC X(10).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-JUICE PIC X(06).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-TEA PIC X(06).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-COFFEE PIC X(06).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-GRADE PIC X(01).

01 W-TOTAL PIC 9(07).  ←作業領域
01 FILE-END PIC 9(01).

PROCEDURE DIVISION.
PROGRAM-START.
	PERFORM START-PROCESS.          ←モジュール（関数）呼び出し
	PERFORM URIAGE-WRITE UNTIL FILE-END = 1.←モジュール（関数）呼び出し FILE-ENDが1になるまで繰り返し
	PERFORM END-PROCESS　　　　　　←モジュール（関数）呼び出し
	STOP RUN.

URIAGE-WRITE. ←モジュール定義
	PERFORM GRADE-CHECK.   ←モジュール（関数）呼び出し
	PERFORM MEISAI-WRITE.  ←モジュール（関数）呼び出し
	PERFORM URIAGE-READ.   ←モジュール（関数）呼び出し

GRADE-CHECK.←モジュール定義
	COMPUTE W-TOTAL = U-JUCE + U-TEA + U-COFFEE.
	
	IF W-TOTAL >= 40000 THEN
		MOVE "good" TO P-GRADE
	ELSE
		MOVE "bad" TO P-GRADE
	END-IF.

MEISAI-WRITE.←モジュール定義
	MOVE U-NAME TO P-NAME
	MOVE U-JUICE TO P-JUICE
	MOVE U-TEA TO P-TEA
	MOVE U-COFFEE TO P-COFFEE
	MOVE W-TOTAL TO P-TOTAL
	WRITE PRINT-REC FROM MEISAI-REC　　※見出しを出力する場合→PERFORM MIDASHI-MEISAI-WRITE.

URIAGE-READ.←モジュール定義
	READ ファイル名A.　
		AT END ←データ終了時の処理
			MOVE 1 TO FILE-END
		NOT AT END ←データ存在時の処理。省略可能
	END-READ.

START-PROCESS.←モジュール定義
	OPEN INPUT 読み込みファイル名
	　　 OUTPUT 書き込みファイル名.←.　の位置に注意!!
	MOVE 0 TO FILE-END       ←判定用変数の初期化
	PERFORM URIAGE-READ.     ←モジュール（関数）呼び出し

END PROCESS.←モジュール定義
	CLOSE 読み込みファイル名
	      書き込みファイル名.


【先頭行に見出しをプリントする】※20レコードごとに先頭行を表示
追加項目
　∟データ部
     01 MIDASHI-REC.
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(05) VALUE "ナマエ".
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(05) VALUE "ジュース".
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(03) VALUE "オチヤ".
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(04) VALUE "コーヒー".
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(05) VALUE "ゴウケイ".
	02 FILLER PIC X(04) VALUE SPACE.
	02 FILLER PIC X(06) VALUE "グレード".

　∟作業領域
　　01 LINE-COUNT PIC 9(02).


　∟手続き部
MOVE 20 TO LINE-COUNT. ←初期値を20に設定して、先頭に見出しを出力する

PERFORM MIDASHI-MEISAI-WRITE.←呼び出し


MIDASHI-MEISAI-WRITE.←関数定義
	IF LINE-COUNT >= 20
	 THEN
		WRITE PRINT-REC FROM MIDASHI-REC AFTER PAGE
		MOVE 0 TO LINE-COUNT
	END-IF.
	WRITE PRINT-REC FROM MEISAI-REC AFTER 2.
	COMPUTE LINE-COUNT = LINE-COUNT + 1.

	  
	  
	  ===================VBA===================
データベース
スキーマ設計
　∟データベースの構造設計（データ型やサイズ等）
インデックスを設定する例
　∟条件に頻繁に利用される
　∟結合（外部キー）等に利用される
　∟複合主キー
　∟ORDER BY / GROUP BY




【ER図】
　∟IE記法	
　∟IDEF1X記法

参照設定
　∟MICROSOFT ACTIVE X DATA OBJECTS /// LIBRARY
Sub GetSQLData()
 
  On Error GoTo ERR_HANDLER
    
    Dim db1 As ADODB.Connection
    Dim rs1 As ADODB.Recordset
    
    '------------------------
    ' DB接続
    '------------------------
    Const strServer = "LAPTOP-IKB12B37\MSSQLSERVER01"
    Const strDb = "YAMA"
    Const strUser = "sa"
    Const strPass = "yama7907T"
    
    Dim strConn As String
    strConn = "Provider=Sqloledb;" & _
              "Data Source=" & strServer & ";" & _
              "Initial Catalog=" & strDb & ";" & _
              "User ID=" & strUser & ";" & _
              "Password=" & strPass & ";" & _
              "Connect Timeout=30;"
    Set db1 = New ADODB.Connection
    db1.Open strConn
    
    '------------------------
    ' SQL実行
    '------------------------
    Dim sql As String
    sql = ""
    sql = sql & "SELECT t.object_id AS オブジェクトID, t.name AS テーブル名, c.column_id AS カラムID, c.name AS 項目名,type_name(user_type_id) AS 属性, max_length AS 長さ, CASE WHEN is_nullable = 1 THEN 'DEFAULT' ELSE 'NOT NULL' END AS NULL許可"
    sql = sql & " FROM sys.objects t INNER JOIN sys.columns c ON t.object_id = c.object_id WHERE t.type = 'U' AND t.name in ('goals')  ORDER BY t.object_id, c.column_id"
'    sql = sql & " SELECT"
'    sql = sql & "   id"
'    sql = sql & "  ,goal_time"
'    sql = sql & " FROM"
'    sql = sql & "   goals"
    
    Set rs1 = New ADODB.Recordset
    rs1.Open sql, db1, adOpenStatic, adLockReadOnly
    
    '------------------------
    ' SQL結果 セルへ貼り付け
    '------------------------
    Do Until rs1.EOF
'        ThisWorkbook.Worksheets("Sheet1").Cells(1 + cnt, 1) = rs1("id")
'        ThisWorkbook.Worksheets("Sheet1").Cells(1 + cnt, 2) = rs1("goal_time")
        ThisWorkbook.Worksheets("Sheet1").Cells(1 + cnt, 1) = rs1("オブジェクトID")
        ThisWorkbook.Worksheets("Sheet1").Cells(1 + cnt, 2) = rs1("カラムID")
        ThisWorkbook.Worksheets("Sheet1").Cells(1 + cnt, 3) = rs1("属性")
        rs1.MoveNext
        cnt = cnt + 1
    Loop
    
    '------------------------
    'データベース閉じる
    '------------------------
    rs1.Close
    Set rs1 = Nothing
    
    db1.Close
    Set db1 = Nothing
    
ERR_HANDLER:
    
    '------------------------
    'データベース閉じる
    '------------------------
    
    If Not rs1 Is Nothing Then
        If rs1.State = adStateOpen Then
            rs1.Close
            Set rs1 = Nothing
        End If
    End If
    
    If Not db1 Is Nothing Then
        If db1.State = adStateOpen Then
            db1.Close
            Set db1 = Nothing
        End If
    End If
     
End Sub

oracle
'TNSサービス名で接続する場合(tnsnames.ora)
Private Const PROVIDER As String = "OraOLEDB.Oracle"
Private Const DATA_SOURCE As String = "orcl"        'ネットサービス名
 
'TNSサービス名を使用せず直接接続する場合
Private Const HOST_NAME As String = "localhost"     'データベースのホスト名orIPアドレス
Private Const PORT_NO   As String = "1521"          'データベースのポート
Private Const SERVICE_NAME As String = "orcl.mshome.net"       'サービス名
 
'データベースのアカウント情報
Private Const USER_ID As String = "sys"            'データベースのユーザID
Private Const PASSWORD As String = "maomaki0427T@"       'データベースのパスワード

Sub sample()
    On Error GoTo ERR_HANDLER
    Dim strSQL As String
    Dim i As Long

    '--------------------------------
    ' データベース接続
    '--------------------------------
    Dim cn As New ADODB.Connection
 
    'TNSサービス名で接続する場合
'    cn.ConnectionString = "Provider=" & PROVIDER _
'                        & ";Data Source=" & DATA_SOURCE _
'                        & ";User ID=" & USER_ID _
'                        & ";PASSWORD=" & PASSWORD
'    cn.Open
 
   'TNSサービス名を使用せず直接接続する場合
   cn.ConnectionString = "Provider=" & PROVIDER _
                       & ";Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)" _
                       & "(HOST=" & HOST_NAME & ")" _
                       & "(PORT=" & PORT_NO & "))" _
                       & "(CONNECT_DATA=" _
                       & "(SERVICE_NAME=" & SERVICE_NAME & ")))" _
                       & ";User ID=" & USER_ID _
                       & ";PASSWORD=" & PASSWORD
   cn.Open

    '--------------------------------
    ' SQLの実行
    '--------------------------------
    Dim rs As New ADODB.Recordset
    strSQL = "select * from uhist"
    rs.Open strSQL, cn
 
    '取得データをセルに一括出力
    rs.MoveFirst
    ActiveSheet.Range("A1").CopyFromRecordset rs

    '--------------------------------
    ' データベース切断
    '--------------------------------
    If Not rs Is Nothing Then
        If rs.State = adStateOpen Then rs.Close
        Set rs = Nothing
    End If
    If Not cn Is Nothing Then
        If cn.State = adStateOpen Then cn.Close
        Set cn = Nothing
    End If

Exit Sub

ERR_HANDLER:

    'エラーメッセージ
    Debug.Print Err.Number & ")" & Err.Description
 
    '--------------------------------
    ' データベース切断
    '--------------------------------
    If Not rs Is Nothing Then
        If rs.State = adStateOpen Then rs.Close
        Set rs = Nothing
    End If
    If Not cn Is Nothing Then
        If cn.State = adStateOpen Then cn.Close
        Set cn = Nothing
    End If
    
End Sub






LAPTOP-IKB12B37\MSSQLSERVER01
sa
yama7907T


USE YAMA
SELECT * FROM GOALS WITH(NOLOCK)

----sql serverの定義を取得するクエリ----
SELECT
    t.object_id             AS オブジェクトID,
	t.name                  AS テーブル名,
    c.column_id             AS カラムID,
	c.name                  AS 項目名,
	type_name(user_type_id) AS 属性,
	max_length              AS 長さ,
	CASE
		WHEN
			is_nullable = 1
		THEN
			'DEFAULT'
		ELSE
			'NOT NULL'
	END AS NULL許可
FROM
	sys.objects t
    INNER JOIN sys.columns c ON t.object_id = c.object_id
WHERE
    -- オブジェクトの種類(U:テーブル(ユーザー定義))
	t.type = 'U'
     AND t.name in ('goals') --と指定すれば特定のテーブルのみ検索可能
ORDER BY
	t.object_id, c.column_id
	  
---------------------COBOL---------------------
拡張子…cob
コメント…*>
文末…．
　∟ピリオドの位置で処理が異なってくる
配列のインデックス番号は1から始まる
文字列の連結…半角スペース

↓プログラムの記述形式
【固定形式】
左から1～6列は記述不可
左7列はコメント（*）を記述する
8列からプログラムを記述していく
　∟_______*DIVISION....みたいな※_は6スペース確保している
【自由形式】
どこから書いてもいいが、コメントが違う
　∟*>


【領域】
入力領域…入力してきたレコード値を保存する領域
出力領域…出力するレコード値を保存する領域
作業領域…編集・加工項目を保存する領域
編集領域…プリントレイアウトを記憶する


レベル番号 ※01～49が可能範囲
レコード名は01
各カラムを02
01が一番上位の階層になる。番号によって　階層関係になる
※レコード名のような全体を集団項目・各カラムのような最小単位を基本項目



DIVISION　>　SECTION
DIVISION…順番必須だが、省略可能
【見出し部】
 ∟①IDENTIFICATION DIVISION.←記述必須　プログラムID
　　 	PROGRAM-ID. 任意の文字列(プログラム名).

【環境部】
環境部（実行環境・入出力ファイル等を記述）書き込み
 ∟②ENVIRONMENT DIVISION.←省略可能
　　 INPUT-OUTPUT SECTION.
     FILE-CONTROL.　　←どのファイルに書き込むか
	 SELECT OUT-FILE※A ASSIGN TO 'ファイル名(例out.txt)'
　　　　 		ORGANIZATION IS LINE SEQUETIAL.　改行で書き込む指定する
※環境部の例
　SELECT URIAGE_F（※ファイル名） ASSIGN TO DISK.
  SELECT PRINT_F  ASSIGN TO PRINTER.


環境部（実行環境・入出力ファイル等を記述）読み込み
 ∟②ENVIRONMENT DIVISION.←省略可能
　　　　INPUT-OUTPUT SECTION.
	  	FILE-CONTROL.　　←どのファイルに書き込むか
	    	SELECT IN-FILE※A ASSIGN TO 'ファイル名(例in.txt)'
　　　　　　  	ORGANIZATION IS LINE SEQUETIAL.　改行で書き込む指定する
	      	STATUS 変数名B.←ステータスを管理するための変数を定義
→③データ部に定義DATA DIVISION.
		  01 変数名B


【データ部】
データ部（変数の定義等を行うエリア）
 ∟③DATA DIVISION.←省略可能
記述例）
DATA DIVISION.
　　FILE SECTION.←ファイル節
	FD ファイル名.　※ファイル名は環境部と同じファイル名
	レコード記述項.
  	WOUKING-STORAGE SECTION.←作業場所節。作業領域を記述
    	01 変数名 PIC X(20).
	∟変数のレベル番号・変数名・PIC・
	∟文字列はX(文字数）又はXを文字数分記述
	∟代入は手続き部エリアにて実施
　　	01 変数名 PIC 9(桁数) ※VALUE デフォルト値.
	∟数値は9(桁数)　又は9を文字数分記述
	∟0埋めされる
	∟デフォルト値はなくても良い

    	01 変数名 PIC 9(桁数)V9(小数点の桁数). 又は9999V99
	∟小数点はVを付与して記述する

　　	01 FILLER PIC X(20). ←文字列20数分の予備領域確保
		


 	環境部の指定時↓書き込み
　　　　　FILE SECTION. ←ファイルセクションを定義する
            FD OUT-FILE※A.
	     01 変数名 PIC 99.
	  WORKING-STORAGE SECTION.
	    01 変数名 PIC 99 VALUE 0.

	環境部の指定時↓読み込み
　　　　　FILE SECTION. ←ファイルセクションを定義する
            FD IN-FILE※A.
	     01 変数名 PIC X(20).
	  WORKING-STORAGE SECTION.
例
FD URIAGE_F.※入力レコードの領域
　O1 URIAGE_REC.
	02 U-NAME   PIC X(10).
	02 U-JUICE  PIC 9(06).
FD PRINT_F.※出力レコードの領域
　O1 PRINT_REC.
	02 P-NAME   PIC X(10).
	02 P-JUICE  PIC 9(06).
WOUKING-STORAGE SECTION.←作業場所節
  O1 MEISAI_REC.
	02 FILLER PIC X(04) VALUE SPACE.※VALUEは作業場所節のみで使用可能　SPACEはスペースで4範囲格納
	02 P-NAME PIX X(10)←レコードの最小単位の名前
	※FILLER…無記名項目という名前が不要な項目
SPACE　一つ以上の空白
ZERO　　一つ以上の0
HIGH-VALUE 
LOW-VALUE




集合項目（※レベル番号は親子関係を表す）
　01 変数名A.
    03 変数名B PIC X(10).
    03 変数名C PIC 9(100).
 ∟使い方は手続き部にて記述

配列
　01 配列名AA.
    03 配列名BB OCCURS 3 PIC X(90). ※OCCURS 領域数


【手続き部】
手続き部
 ∟④PROCEDURE DIVISION.←記述必須
       MAIN SECTION.※節名称 SECTION
	MOVE 文字列 TO 変数名.←変数名に代入する
	DISPLAY 変数名.
	*>集合項目↓
	MOVE 文字列B TO 変数名B.←集合項目代入
	MOVE 文字列C TO 変数名C.←集合項目代入
	DISPLAY 変数名A         ←変数名B,Cを出力する
	DISPLAY 変数名C         ←変数名Cのみ出力する
	*>配列↓
	MOVE 文字列BB TO 配列名BB(1).
	STOP RUN.※節名称の終了

指示の内容
OPEN INPUT ファイル名A　　　←入力用
     OUTPUT ファイル名B.※.は一つ←出力用
READ ファイル名A.　←データ部のファイル名 1レコードの処理を記述できる
	AT END データ終了時の処理
	NOT AT END データ存在時の処理
END-READ.

出力処理
WRITE レコード名.←データ部のレコード名
※ WRITE レコード名 FROM 編集領域.　※AFTER PAGE.←改行 AFTER 2.←飛ばし改行


DISPLAY 表示させる指示

CLOSE ファイル名A  ファイルを閉じる
      ファイル名B.
STOP RUN.　プログラム終了

【代入】
MOVE 変数1 TO 変数2.

MOVE 変数1 TO 変数2
              変数3.※変数1を２，３に代入する

※桁数の違い
小数点の位置に合わせて上位が切り捨てられる
0埋め

文字は下位が切り捨て
空白埋め




★計算
データ部
DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 NUM-1
	03 D1 PIC 9(5) VALUE 0.
	03 D2 PIC 9(5) VALUE 0.
	03 D3 PIC 9(5) VALUE 0.
	03 D4 PIC 9(5) VALUE 0.

手続き部
足し算
　∟ADD 5 TO D1. ←D1+5
　∟ADD 6 TO D1 D3 D4. ←D1+5　D3+5　D4+5
引き算
　∟SUBTRACT 4 FROM D1. ←D1-4
割り算
　∟DIVIDE D1 BY D2 GIVING D3 REMAINDER D4, ←D1/D2 D3に答え代入（GIVING） D4に余り代入（REMAINDER）
かけ算
　∟MULTIPLY D1 BY D2 GIVING D3 ←D1*D2 D3に答え代入（GIVING）

その他の処理
　∟COMPUTE D3 = D1 * D2. ←かけ算と同じ処理を実施　＋－／＊　**

COMPUTE 変数 = へんすう + HENNSUU / HENNSUU3 * 5.※間に半角空白が必要
COMPUTE へんすう ROUNDED = ※少数第一を四捨五入する　ないと切り捨て

オーバーフローの対応
　COMPUTE へんすう　＝
	ON SIZE ERROR
		オーバーフロー時の処理
	NOT ON SIZE ERROR
 		じゃないときの処理
END-COMPUTE.


★インプットボックス
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名V PIC X(80).
 
手続き部
  DISPLAY 質問？.
  ACCEPT 変数名V.


★条件分岐
END-IFの後にのみ.を記述する
①
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名N PIC 9(2).

手続き部
【条件分岐】
 IF 変数名N > 60
	THEN
  		TRUEの処理
 	ELSE
　		FALSEの処理
 END-IF.
 ※　ELSE CONTINUE…何もしないで次の処理に移動。書かなくても良い
※ネストは可能。ネストの場合は一番外の処理に．を記述する

【条件分岐2】
EVALUATE TRUE
	WHEN 条件 
		処理
	WHEN 条件
		処理
	WHEN OTHER
		処理
END-EVALUATE.

EVALUATE データ値
	WHEN 値1 THRU 値2 ※範囲指定 値1以上値2以下と同等
		処理
	WHEN 値
		処理
	WHEN OTHER
		処理
END-EVALUATE.


【比較演算子】
・= (IS EQUAL TO)
・NOT = (IS NOT EQUAL TO)
・> (IS GREATER THEN)
・>= (IS GREATER THEN OR EQUAL TO)
・< (IS LESS THAN)
・<= (IS LESS THEN OR EQUAL TO)

【論理演算子】
AND
OR


②
EVALUATE
END-EVALUATEの後にのみ.を記述する
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名X PIC X(2).

手続き部
  MOVE 文字列 TO 変数名X.
  EVALUATE 変数名X
　　WHEN "AAA"
	処理AAA
    WHEN "BBB"
        処理BBB
    WHEN OTHER
        当てはまらない処理
  END-EVALUTE.


★繰り返し
END-PERFORMの後にのみ.を記述する
①
データ部※入力値を格納する変数を定義
 DATA DIVISION
  WOUKING-STORAGE SECTION.
    01 変数名N PIC 9(2) VALUE 1.

手続き部
  PERFORM 10 TIMES  ←10回繰り返す
    処理
    ADD 1 TO 変数名N 
  END-PERFORM.


②
　PERFORM UNTIL 変数名N > 10  ←条件に達したら処理終了
　　処理
　　ADD 1 TO 変数名N ←無限を防ぐ
  END-PERFORM.

③
　PERFORM VARYING 変数名N FROM 1 BY 1 UNTIL 変数名N > 10
    処理
  END-PERFORM.
  ∟FROM…開始
　∟BY…づつ
　∟UNTIL…条件に達するまで


★ファイルを書き込む
　∟
手続き部 OPEN OUTPUT OUT-FILE.※A
	PERFORM 10 TIMES←ループ文
	  ADD 1 TO LINE-COUNT
	  MOVE LINE-COUNT TO 変数名※ファイルセクションを定義した変数名
	  WRITE 変数名※ファイルセクションを定義した変数名
	END-PERFORM.

	CLOSE OUT-FILE.※A
∟ファイルの確認
ターミナル画面
　　∟less ファイル名

★ファイルの読み込み
事前にin.txtが存在する前提
手続き部 OPEN INPUT IN-FILE.※A
	PERFORM UNTIL 変数名　NOT = "00"←ループ文 正常なら00が返る　変数はWORKING-STORAGEで定義した変数
	　READ IN-FILE
	    AT END　
		※データが読み終わった際の処理
 	    NOT AT END　
		※データ読み込み途中の処理
		DISPLAY 変数名※ファイルセクションを定義した際の変数
	  END-READ
	END-PERFORM.

	CLOSE IN-FILE.※A




【例題】
IDENTIFICATION DIVISION.
PROGRAM-ID. プログラム名.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.　　
	 SELECT 読み込みファイル名 ASSIGN TO DISK.
         SELECT 書き込みファイル名 ASSIGN TO PRINTER.	

DATA DIVISION.
FILE SECTION.←ファイル節
FD 読み込みファイル名.
01 URIAGE-REC.
	02 U-NAME PIC X(10).　←入力領域は各カラムの値
	02 U-JUICE PIC 9(06).
	02 U-TEA PIC 9(06).
	02 U-COFFEE PIC 9(06).
FD 書き込みファイル名.   ←出力領域は全ての結果を羅列
01 PRINT-REC PIC X(60).

WOUKING-STORAGE SECTION.←作業場所節。作業領域を記述
01 MEISAI-REC.
	02 FILTER PIC X(04) VALUE SPACE.　←編集領域
	02 P-NAME PIC X(10).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-JUICE PIC X(06).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-TEA PIC X(06).
	02 FILTER PIC X(03) VALUE SPACE.
	02 P-COFFEE PIC X(06).

01 W-TOTAL PIC 9(07).  ←作業領域

PROCEDURE DIVISION.
PROGRAM-START.
	OPEN INPUT 読み込みファイル名
	　　 OUTPUT 書き込みファイル名.
	READ 読み込みファイル名.
	COMPUTE W-TOTAL = U-JUCE + U-TEA + U-COFFEE.
	
	IF W-TOTAL >= 40000 THEN
		MOVE "good" TO P-GRADE
	ELSE
		MOVE "bad" TO P-GRADE
	END-IF.
	
	MOVE U-NAME TO P-NAME
	MOVE U-JUICE TO P-JUICE
	MOVE U-TEA TO P-TEA
	MOVE U-COFFEE TO P-COFFEE
	MOVE W-TOTAL TO P-TOTAL
	WRITE PRINT-REC FROM MEISAI-REC

	CLOSE 読み込みファイル名
	      書き込みファイル名.
	STOP RUN.




	  
-----------C#-----------
ビルドで作成されるファイル
　∟コンソールアプリケーションやWINDOWSアプリケーションは「EXE」
　∟クラスは「DLL」
※bin>Debug

ローカルウィンドウ
　∟変数の内容を確認できる
namespaceは.で区切って記述可能　または　ネスト namespace a {namespace b{定義 }}

ソリューションエクスプローラの参照でusing　で使用する定義を追加する
　∟右クリック>参照の追加をクリック

コメントにはXMLのためのコメントもある
　∟///<tug>///コメント内容///</tug>※///


【定数】
const 定数名 = 値;
　∟全て大文字にする

【データ型】
参照　string object (=null※参照型)※値型でもデータ型? 変数　= nullを格納できる

int / double / long / float floatはfを末に記述※記述なしだとdobleになってしまう→型変換必要
char c = 'a'※シングルクォーテーション
bool
DateTime 変数 = Datetime.Now ※現在

【日付】
DateTime.Now.※（置換する）　※Year Month Day Hour Minute　Second

大きいデータ型から小さいデータ型は変換が必要

＋　で文字列連結
文字変数.Length…文字数を取得
string.Empty　は　"" と同等の意味
エスケープシーケンス
　∟\\…\
　∟\'…'




【VS環境構築】
ソースコードに行番号を表示させる（デバック時の表示行で判断を速くでる）
　∟メニュー→ツール>オプション>テキストエディタ>C#>行番号(L)


【配列】
int[] 配列変数 = new int[要素数]
また　
int[] 配列変数 = ｛値1, 値2｝
・配列変数.Length　要素数を取得
多次元配列
　∟int[,] 配列名 = new [4,2]
また
int[,] 配列名 = {{3,54},{63,5},{1,76}}
・配列変数.GetLength(0)　縦の要素数を取得
・配列変数.GetLength(1)　横の要素数を取得
ジャグ配列
int[][] 変数名 = new int[2][]
配列変数[0] = new int[2]{10,30}
配列変数[1] = new int[4]{4,10,30,4}

【動的配列】
useing System.Collections.Genericが必要
list<データ型> 変数名 = new list<データ型>
変数名.Add(値)   ※追加 データ型が合致していること
変数名.Remove(値)　　※削除　値で削除する
変数名.RemoveAt(インデックス番号)※削除 インデックスで削除する
要素数は.Countで取得できる


【演算子】
文字列連結…+

【コンソール出力】
Console.WriteLine()…空文字列を出力

【型変換】
int 変数　= (int)値　※値がlong型の場合,値は損なわれるが型変換できる
　∟ダブル型をintに変換すると小数点以下切り捨てられる
文字列への変換
　∟変数名.ToString()※d,D,t,T,C　書式して文字列 引数として可能
DateTime a = DateTime.Now()
変数 = a.ToString("d")
int b = 134
変数 = b.ToString("C") \付きの文字列
変数 = b.ToString("F2")小数点桁数を追加した文字列
変数 = b.ToString("N2")カンマ編集

Parseメソッド…変換できないと例外が発生する
データ型　変数 = データ型.Parse(文字列)
string b = "2024/01/03"
DateTime a = DateTime.Parse(b)
変数 = int.Parse(文字列);

TryParse ※変換できればtrue　例外が発生しない 
int hennsuu
bool　変数　= int.TryParse("20", out hennsuu)←hennsuuにint型の20を格納し、変数にはboolを格納
　

【if】
if(){}
else if(){}
else{}

【switch】
switch (条件){ case 値1:処理;break; default: 処理;break;}
※goto case 値1;で制御を移動させることも可能


【while】
while(条件){}
do{ 処理}(条件);←１度は処理が実行される


【for】
for(int i=0 ;i<10; i++){}※初期値はブロック前でも宣言可能(;i<10;i++)みたいに記述
foreach( データ型　変数　in 配列）{}
 

【クラス】
オーバーロード…引数の違うメソッド←引数に合わせて自動で呼び出してくれる
　∟戻り値が異なるだけ、仮引数の名前が違うだけ　などではコンパイルエラーになる

public string プロパティ名※valueという特殊文字で設定できる
get
{return}
set
{プロパティ名=value}
　※プロパティーの数だけ定義する set{}を定義しないと読み取り専用になる

※メソッドの定義が不要
public string プロパティ名 {get; set;}読み書き両方
　∟{get; private set;}※読み取り専用setができない

【static】クラスに紐付いた情報
クラス名.メソッド名※インスタンスしていないでも利用可能
プロパティ名においても public static データ型　プロパティ名で利用できる
　∟プロパティの呼び出し　クラス名.プロパティ名
※static を const　に記述しても同じ意味になる←二つ指定はビルドエラーになる
※readonly　をフィールド名に対して追加記述すると読み取り専用になる
　∟static コンストラクタ←static クラス名(){}ここで初期化も可能※const は宣言時のみ初期化が可能
public static DateTime.Now{get} 現在日時を取得する
プロパティの呼び出し
　∟クラス名.プロパティ名

【クラスの継承】　※：派生クラス名が無いと:Objectとなっている
基本クラスを定義→派生クラス
※基本クラスのプロパティにprotectedにすると、派生クラスからでもアクセスできる
派生クラスの定義　class 派生クラス名 :基本クラス名

オーバーライド
　∟基本クラス　pubic virtual void メソッド名()
　∟派生クラス　public override void メソッド名()※基本クラスと同じメソッド名だよ
base.メソッド名　派生クラスから基本クラスのメソッドを呼び出す
コンストラクタの基本クラスを呼び出す
　派生クラスコンストラクタ public クラス名 ():base(引数、引数)←基本クラスのコンストラクタを実装する


【例外】
try{}
catch(例外名　変数名){}※複数記述可能
　∟catch(例外名　変数名)　when (実行したい条件※trueの場合に処理を実行){}
finally{}
	・変数名.Messageメッセージを出力する
・変数名.Sourceオブジェクトの名前
・変数名.ToString詳細情報を出力する　

OverflowException…許容範囲以外の数値の場合
FormatExcenption…数値に変換できない（空文字　文字列）
DivideByZeroException…0で割り算をした場合
IndexOutOfRangeExxeption…配列の範囲外にアクセスした場合
NullReferenceException…null参照の場合に発生
Data.SqlClient.SqlException…SQL Serverでエラーが通知された際に発生
InvaidCastException…キャストが不適切の場合に発生


string.IsNullOrEmpty(値)…null 、空ならtrue

【例外　throw】

throw new 空Exception();

※catch(～Exception 変数名)の内部　※ex(変数)はオブジェクトになる
　∟throw;そのままスロー
　∟throw ex ; その場所が例外の起点になる
　∟throw new ～Exception("エラーメッセージ",ex);


【その他】
TextBox.Textはstringなので数値にする場合は数値型に変換する
数字を文字列にする場合は変換する
　∟int 変数;
　∟int.TryParse(～TextBox.Text, out 変数)
　∟～.Text = 値.ToString();

this.Close()でフォームを閉じる


FORM
 ∟・FormBorderStyle(フォームの仕切り表示)・StartPosition(フォームの表示位置)・Text(フォームのタイトル文字)
TEXTBOX
 ∟・BackColor(背景色※Control/入力できないのを視覚的に表現する)・MultiLine(複数行の入力)・ReadOnly(入力不可)
NUMERICUPDOWN1
　∟・Maximum/最大値・Minimum/最小値・


フォームを閉じる
　∟this.Close();

ランダム値を算出する
　∟Random random = new Random();
　　aswerNumber = random.Next(0,1000)+1;

メッセージを表示する
　∟ MessageBox.Show("THANK YOU!!");

decimal→int型に変更する
　∟Decimal.ToInt32(numericUpDown1.Value) または　(int)numericUpDown1.Value
　数値表現が大→小は暗黙的にデータ型変換が可能。逆（小→大）は不可能

string型に変換する
　∟maxAnswerCount.ToString();

改行
　∟Environment.NewLine

★参照されるフォームの変数はpublicにする
★this.Hide();←this.Closeでは変数を渡せないので渡すまではthis.Hide();で隠す
★Form2 a = new Form2();
a.ShowDialog();
　∟参照元で開く
a.Close();
　∟参照先のフォームを閉じる※変数を渡した後に実行する
★numericUpDown1.Maximum = maxNumber;※最大値も変更すること


○input Boxを利用する場合は参照設定が必要
　∟参照の追加→アセンブリ→MicrosoftVisualBasicにチェックを入れる
string input = Microsoft.VisualBasic.Interaction.InputBox(
                    "値を入力してください。",
                    "値の入力",
                    "yama",
                    -1,
                    -1);
○数値を判定するロジック
int d;
if (int.TryParse(input, out d) == false){
    return;
}
  </code>
</pre>
  
</body>
</html>
