<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>upload</title>
</head>
<body>
  <h1>名前で保存する</h1>
  <p>d6 リソースシートb3 完了以外を表示</p>
  <p>新しい情報です</p>
<pre>
  <code>



use idmdb

---該当日に該当するWS受注を取得

SELECT
TEMP.JUCFL_KYKNO
,TEMP.JUCFL_JUCNO
,1 AS GAITOU
INTO #TEMP_TWS
FROM (
	SELECT
		 T2.JUCFL_KYKNO
		,T2.JUCFL_JUCNO
	FROM SKUMS AS T1 WITH(NOLOCK)
	INNER JOIN JUCFL AS T2 WITH(NOLOCK)
	   ON T1.SKUMS_CTGL = 19
	  AND T1.SKUMS_CTGM = 8
	  AND T1.SKUMS_CTGS = 2
	  AND T2.JUCFL_SKUCD = T1.SKUMS_SKUCD
	  AND T2.JUCFL_COLOR = T1.SKUMS_COLOR
	  AND T2.JUCFL_SIZE  = T1.SKUMS_SIZE
	  AND T2.JUCFL_PGYO  = T2.JUCFL_JUCGYO
	  AND T2.JUCFL_JUCBI BETWEEN 20250101 AND 202050101
	WHERE T1.SKUMS_DELFLG = 0
) AS TEMP
GROUP BY TEMP.JUCFL_KYKNO,TEMP.JUCFL_JUCNO


---定期契約の数を取得

SELECT T2.TEKFL_KYKNO,T2.TEKFL_TEKSEQ
INTO #TEMP_TEKFL
FROM #TEMP_TWS AS T1
INNER JOIN TEKFL AS T2 WITH(NOLOCK)
ON T2.TEKFL_KYKNO = T1.JUCFL_KYKNO
GROUP BY T2.TEKFL_KYKNO,T2.TEKFL_TEKSEQ

--- 顧客の定期契約件数を算出
SELECT
TEKFL_KYKNO
,COUNT (*) AS TEKFL_CNT
INTO #TEMP_TEKFL_CNT
FROM #TEMP_TEKFL
GROUP BY TEKFL_KYKNO


---定期契約が1つの顧客の対象受注以下のWSを全て取得
SELECT
	 TEMP.JUCFL_KYKNO
	,TEMP.JUCFL_JUCNO
	,TEMP.JUCFL_TEKSEQ
INTO #TEMP_S_WS
FROM (
	SELECT
		 T2.JUCFL_KYKNO
		,T3.JUCFL_JUCNO
		,ISNULL(T3.JUCFL_TEKSEQ,0) AS JUCFL_TEKSEQ
	FROM #TEMP_TEKFL_CNT AS T1
	INNER JOIN #TEMP_TWS AS T2
	   ON T2.JUCFL_KYKNO = T1.JUCFL_KYKNO
	INNER JOIN JUCFL AS T3 WITH(NOLOCK)
	   ON T3.JUCFL_KYKNO  = T2.JUCFL_KYKNO
	  AND T3.JUCFL_JUCNO <= T2.JUCFL_JUCNO 
	  AND T3.JUCFL_PGYO   = T3.JUCFL_JUCGYO
	INNER JOIN SKUMS AS T4 WITH(NOLOCK)
	   ON T4.SKUMS_CTGL   = 19
	  AND T4.SKUMS_CTGM   = 8
	  AND T4.SKUMS_CTGS   = 2
	  AND T4.SKUMS_DELFLG = 0
	  AND T4.SKUMS_SKUCD  = T2.JUCFL_SKUCD
	  AND T4.SKUMS_COLOR  = T2.JUCFL_COLOR
	  AND T4.SKUMS_SIZE   = T2.JUCFL_SIZE
	WHERE T1.TEKFL_CNT = 1
) AS TEMP
GROUP BY TEMP.JUCFL_KYKNO,TEMP.JUCFL_JUCNO,TEMP.JUCFL_TEKSEQ

---　定期契約が1つの顧客の受注順位づけ
SELECT
	*
INTO #TEMP_S_JUC
FROM (
SELECT
	 ROW_NUMBER() OVER (PARTITION BY JUCFL_KYKNO ORDER BY JUCFL_JUCNO) AS JUC_NUM
	,JUCFL_KYKNO
	,JUCFL_JUCNO
	,JUCFL_TEKSEQ
FROM #TEMP_S_WS
) AS TEMP
WHERE TEMP.JUC_NUM = 1


---定期契約が1つの顧客で登録が必要な受注を取得する
INSERT INTO #WINC 
SELECT
	 T1.JUCFL_KYKNO
	,T2.JUCFL_JUCNO
	,CASE WHEN T2.JUCFL_TEKSEQ = 0 THEN T3.TEKFL_TEKSEQ ELSE T2.JUCFL_TEKSEQ END AS JUCFL_TEKSEQ
FROM #TEMP_TWS AS T1
INNER JOIN #TEMP_S_JUC AS T2
ON T2.JUCFL_KYKNO = T1.JUCFL_KYKNO
AND T2.JUCFL_JUCNO = T1.JUCFL_JUCNO
INNER JOIN #TEMP_TEKFL AS T3
ON T3.TEKFL_KYKNO = T2.JUCFL_KYKNO


--- 定期契約が複数ある顧客
SELECT
	 TEMP.JUCFL_KYKNO
	,TEMP.JUCFL_JUCNO
	,TEMP.JUCFL_JUCBI
	,TEMP.JUCFL_TEKSEQ
	,0 AS UPDFLG
INTO #TEMP_O_WS
FROM (
	SELECT
		 T2.JUCFL_KYKNO
		,T3.JUCFL_JUCNO
		,T3.JUCFL_JUCBI
		,ISNULL(T3.JUCFL_TEKSEQ,0) AS JUCFL_TEKSEQ
	FROM #TEMP_TEKFL_CNT AS T1
	INNER JOIN #TEMP_TWS AS T2
	   ON T2.JUCFL_KYKNO = T1.JUCFL_KYKNO
	INNER JOIN JUCFL AS T3 WITH(NOLOCK)
	   ON T3.JUCFL_KYKNO  = T2.JUCFL_KYKNO
	  AND T3.JUCFL_JUCNO <= T2.JUCFL_JUCNO 
	  AND T3.JUCFL_PGYO   = T3.JUCFL_JUCGYO
	INNER JOIN SKUMS AS T4 WITH(NOLOCK)
	   ON T4.SKUMS_CTGL   = 19
	  AND T4.SKUMS_CTGM   = 8
	  AND T4.SKUMS_CTGS   = 2
	  AND T4.SKUMS_DELFLG = 0
	  AND T4.SKUMS_SKUCD  = T2.JUCFL_SKUCD
	  AND T4.SKUMS_COLOR  = T2.JUCFL_COLOR
	  AND T4.SKUMS_SIZE   = T2.JUCFL_SIZE
	WHERE T1.TEKFL_CNT <> 1
) AS TEMP
GROUP BY TEMP.JUCFL_KYKNO,TEMP.JUCFL_JUCNO,TEMP.JUCFL_JUCBI,TEMP.JUCFL_TEKSEQ

--- TEKSEQがない定期契約番号を当てはめる
SELECT
 TMP.JUCFL_KYKNO
,TMP.JUCFL_JUCNO
,TMP.TEKFL_TEKSEQ
INTO #UPD_TEKSEQ
FROM (
	SELECT
		TEMP.*
		,ROW_NUMBER()OVER(PARTITION BY JUCFL_KYKNO,JUCFL_JUCNO ORDER BY TEMP.DAY_DIFF) AS NEAR_DAY
	FROM(
		SELECT
			 T1.JUCFL_KYKNO,T1.JUCFL_JUCNO,T2.TEKFL_TEKSEQ
			,ABS(DATEDIFF(DAY,CONVERT(DATE, CONVERT(VARCHAR(8), T1.JUCFL_JUCBI)),CONVERT(DATE, CONVERT(VARCHAR(8), T2.TEKFL_TOROKBI)))) AS DAY_DIFF
		FROM #TEMP_O_WS AS T1
		INNER JOIN TEKFL AS T2 WITH(NOLOCK)
		ON T2.TEKFL_KYKNO = T1,JUCFL_KYKNO
		WHERE T1.JUCFL_TEKSEQ = 0
	) AS TEMP
) AS TMP
WHERE TMP.NEAR_DAY = 1

UPDATE T1
SET T1.UPDFLG = 1,T1.JUCFL_TEKSEQ = T2.TEKFL_TEKSEQ
FROM #TEMP_O_WS AS T1
INNER JOIN #UPD_TEKSEQ AS T2
ON T2.JUCFL_KYKNO = T1.JUCFL_KYKNO
AND T2.JUCFL_JUCNO = T1.JUCFL_JUCNO

---　定期契約が複数の顧客の受注順位づけ
SELECT
	 TEMP.JUCFL_KYKNO
	,TEMP.JUCFL_JUCNO
	,TEMP.TEKFL_TEKSEQ
INTO #TEMP_O_JUC
FROM(
SELECT
	ROW_NUMBER() OVER(PARTITION BY T1.JUCFL_KYKNO,T1.TEKFL_TEKSEQ ORDER BY JUCFL_JUCNO) AS JUC_NUM
	,T1.JUCFL_KYKNO
	,T1.JUCFL_JUCNO
	,T1.JUCFL_JUCBI
FROM #TEMP_O_WS AS T1
) AS TEMP
WHERE TEMP.JUC_NUM = 1

---定期契約が複数の顧客で登録が必要な受注を取得する
INSERT INTO #WINC 
SELECT
	 T1.JUCFL_KYKNO
	,T2.JUCFL_JUCNO
	,T2.TEKFL_TEKSEQ 
FROM #TEMP_TWS AS T1
INNER JOIN #TEMP_O_JUC AS T2
ON T2.JUCFL_KYKNO = T1.JUCFL_KYKNO
AND T2.JUCFL_JUCNO = T1.JUCFL_JUCNO

--- T_WINC_AGRに情報が存在したら、除外する
IF @KBN = 0 BEGIN 
	DELETE T1 FROM #WINC AS T1 WHERE EXISTS (SELECT * FROM T_WINC_AGR AS T2 WITH(NOLOCK) WHERE T2.KYKNO = T1.JUCFL_KYKNO AND T2.TEKSEQ = T1.TEKFL_TEKSEQ)
END

DECLARE @CNT DECIMAL(9)
SELECT @CNT = COUNT(*) FROM #WINC

--- 早期リターン
IF @CNT = 0 BEGIN
	PRINT '新しく追加される情報はないので、処理を終了します。'
	RETURN
END

--- 初回契約情報を付与する
--- 地区,BYTAISBを情報を更新


SELECT T1.*,HANTR_CHIKU,HANTR_PROMOCD,HANTR_GKJUC AS DBG_HANTR_GKJUC,HANTR_SIRTAN AS DBG_HANTR_SIRTAN FROM #WINC AS T1
INNER JOIN T_HANTR_HIST AS T2 WITH(NOLOCK)
ON T2.HANTR_KYKNO = T1.JUCFL_KYKNO
AND T2.HANTR_JUCNO = T1.JUCFL_JUCNO
AND T2.HANTR_JSKKB = 11
AND T2.HANTR_DELFLG = 0
AND T2.HANTR_PROMOCD <> 'SETKO'
INNER JOIN SKUMS AS T3 WITH(NOLOCK)
ON T3.SKUMS_CTGL = 19
AND T3.SKUMS_CTGM = 8
AND T3.SKUMS_CTGS = 2
AND T3.SKUMS_SKUCD = T2.HANTR_SKUCD
AND T3.SKUMS_COLOR = T2.HANTR_COLOR
AND T3.SKUMS_SIZE  = T2.HANTR_SIZE
AND T3.SKUMS_DELFLG = 0




INNER JOIN PROMS AS T2 WITH(NOLOCK)
ON T2.PROMS_PROMOCD = T1,HANTR_PROMOCD
AND T2.PROMS_DELFLG = 0
INNER JOIN BYTAI AS T3
ON T3.BYTAI_BYTAICD = T2.HANTR_BAYTAICD
AND T3.BYTAI_DELFLG = 0

--- 契約本数情報

SELECT * FROM 
LEFT JOIN TEKTR AS T2
ON T2.TEKTR_KYKNO = T1._KYKNO
AND T2.TEKTR_TEKSEQ = T1._TEKSEQ





    
<%@ Language=VBScript %>
<!--#include file="config.inc" -->
<% 


Response.CodePage = 932  
Response.Charset = "Shift_JIS"

'グローバル変数定義
Dim hen1, hen2, hen3, hen4, openflg
Dim errMsg, pageSize, page, totalPages, suPage
Dim connStr
Dim action
Dim selectedItems, k, id, gk, parts, updateSql, rows, key
Dim conn, rs, sql, rs_hantr, sql_s, s_count, hyoji_count
Dim devcon, upvalues, bikou_value
Dim editData, records, item, keys, bikou_values, delData, derecords, deleteSql
Dim insertData, newRecords, gk_val, bikou_val, sqlInsert, insert_empno


action = Request("action")
editData = Request.Form("edit_data")
delData  = Request.Form("delete_data")
insertData = Request.Form("insert_data")

errMsg = ""
openflg = 0
suPage = 1
pageSize = 10 ' 1ページあたりの件数

If Request.ServerVariables("REQUEST_METHOD") = "POST" Then
    openflg = Request.Form("openflg")
    suPage = Request.Form("supage")
    hen1 = Request.Form("empno")
    hen3 = Request.Form("empname")

    If hen3 = "" Then
        errMsg = "従業員は必須です。"
    Else

If editData <> "" or delData <> "" or insertData <> "" Then
'updateの処理
    records = Split(editData, "###")
        For Each item In records
            keys = Split(item, "_")
            If UBound(keys) = 1 Then
                bikou_values = Replace(keys(1), "'", "''") ' SQLインジェクション対策
                    updateSql = "UPDATE hantr SET bikou = '" & bikou_values & "' WHERE id = " & keys(0)
                    Set devcon = Server.CreateObject("ADODB.Connection")
                    devcon.Open connStr
                    devcon.Execute updateSql
                    devcon.Close
                    Set devcon = Nothing
            End If
        Next
'deleteの処理
    derecords = Split(delData, "###")
        For Each item In derecords
            keys = Split(item, "_")
            If UBound(keys) = 1 Then
                deleteSql = "DELETE FROM hantr WHERE id = " & keys(0)
                Set devcon = Server.CreateObject("ADODB.Connection")
                devcon.Open connStr
                devcon.Execute deleteSql
                devcon.Close
                Set devcon = Nothing
            End If
        Next
'insertの処理
    newRecords = Split(insertData, "###")
    For Each item In newRecords
        keys = Split(item, "_")
        If UBound(keys) = 2 Then
            insert_empno = Replace(keys(0), "'", "''")
            gk_val = Replace(keys(1), "'", "''")
            bikou_val = Replace(keys(2), "'", "''")
            sqlInsert = "INSERT INTO hantr (gk, bikou, emp_no) VALUES ('" & gk_val & "', '" & bikou_val & "', " & insert_empno & ")"
            Set devcon = Server.CreateObject("ADODB.Connection")
            devcon.Open connStr
            devcon.Execute sqlInsert
            devcon.Close
            Set devcon = Nothing
        End If
    Next
End If
        
    End If
End If



    
    Set conn = Server.CreateObject("ADODB.Connection")
    conn.Open connStr

    sql = "SELECT * FROM kykms"
    Set rs = conn.Execute(sql)

If Not(openflg = 0) And Not(hen3 = "") Then
sql_s = ""
    page  = 0
    sql_s = "SELECT * FROM hantr where emp_no = " & hen1

    Set rs_hantr = Server.CreateObject("ADODB.Recordset")
    rs_hantr.CursorLocation = 3 
    rs_hantr.Open sql_s, conn, 3, 1 
    s_count = rs_hantr.RecordCount
    If s_count > 0 Then
    totalPages = Int((s_count + pageSize - 1) / pageSize)
        page = CInt(suPage)
        If page < 1 Then page = 1
        If page > totalPages Then page = totalPages
        Dim startRecord
        startRecord = (page - 1) * pageSize + 1
        If s_count > 0 Then
            rs_hantr.MoveFirst
            rs_hantr.Move startRecord - 1
        End If
    End If
End If

Sub finalexe()
    rs.Close
    If Not(openflg = 0) And Not(hen3 = "") Then
        rs_hantr.Close
    End If
    Set rs = Nothing
    Set rs_hantr = Nothing
    conn.Close
    Set conn = Nothing
End Sub

Sub SerchPager()
Dim s_cla, e_cla
s_cla = ""
e_cla = ""
If s_count <= 0 Or totalPages = 1 Then
    s_cla = "not"
    e_cla = "not"
Else
    If page <= 1 Then
        s_cla = "not"
    ElseIf page >= totalPages Then
        e_cla = "not"
    End If

End If

                 %>
                <button type="submit" name="supage" value="<%=page-1%>" class="<%=s_cla%>">前へ</button>
                <button type="submit" name="supage" value="<%=page+1%>" class="<%=e_cla%>">次へ</button>
                <% 
                hyoji_count = 0
                If s_count > 0 Then 
                    hyoji_count = s_count
                %>
                    <span>件数:<%=hyoji_count%> 件 ページ <%=page%> / <%=totalPages%>）</span>
                <%
                Else
                %>
                    <span>件数: <%=hyoji_count%> 件</span>
                <%
                End If
                %>
                <%
End Sub
%>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="style.css">
<title>これはテストです</title>
</head>
<body>

        <h1>ここから下はサーバーからの情報です編集してみました</h1>
                <form  method="post">
            <div class="div_f_container">
                <input type="hidden" name="openflg" value=1>
                <input type="hidden" name="edit_data" id="edit_data">
                <input type="hidden" name="delete_data" id="delete_data">
                <input type="hidden" name="insert_data" id="insert_data">
                従業員番号: <input type="text" id="empno" name="empno" onblur="getName()" value="<%=Server.HTMLEncode(hen1)%>">
                氏名: <input type="text" id="empname" readonly name="empname" value="<%=Server.HTMLEncode(hen3)%>"><br>
                検索:<input type="submit" name="action" value="検索" style="width:150px; height:30px;"><br>   
                登録:<button type="submit" name="action" value="登録" style="width:150px; height:30px;" onclick="update_value()">登録</button>
                新規行追加:<button type="button" name="insert" value="新規" id="insert" style="width:150px; height:30px;">新規行追加</button><br>
            </div>
            <div class="pager"> 
                <% Call SerchPager() %>
            </div>
            
<% 
                If s_count > 0 Then
                %>
                <table border="1">
                    <colgroup>
                    <col style="width: 50px;">
                    <col style="width: 200px;">
                    <col style="width: 300px;">
                    <col style="width: 400px;">
                    <col style="width: 50px;">
                    </colgroup>
                <tr><th>編集</th><th>ID</th><th>gk</th><th>bikou</th><th>削除</th></tr>
                <%
                    Dim i
                    i = 0
                    While Not rs_hantr.EOF And i < pageSize
                %>
                    <tr class="" id="tr_<%=i%>">
                        <td><input type="checkbox" name="edit_id" data-num="<%=i%>" id="edit_<%=i%>" value="<%=i%>" onclick="toggleEdit(this)"></td>
                        <td>
                            <input type="text" class="readonly-style"
                            name="id" 
                            value="<%=rs_hantr("id")%>"
                            readonly>
                        </td>
                        <td>
                            <input type="text" class="readonly-style"
                            name="gk" 
                            value="<%=rs_hantr("gk")%>"
                            readonly>
                        </td>
                        <td>
                            <input type="text" class="readonly-style"
                            name="bikou_<%=rs_hantr("id") & "_" & rs_hantr("gk")%>"
                            data-bg="<%=i%>" 
                            id="bikou_<%=i%>"
                            value="<%=Server.HTMLEncode(rs_hantr("bikou"))%>"
                            data-idn="<%=Server.HTMLEncode(rs_hantr("id"))%>"
                            readonly>
                        </td>
                        <td><input type="checkbox" name="delete_id" data-num="<%=i%>"  class="accent_c" id="delete_<%=i%>" name="delete_id"  value="<%=i%>" onclick="toggleEdit(this)"></td>
                    </tr>
                <%
                        rs_hantr.MoveNext
                        i = i + 1
                    Wend
                %>
                    </table>
                </form>
                <%
                End If

                    
                Call finalexe()
                If Not(errMsg = "") Then
                %>
                <p><%=errMsg%></p>
                <%
                End If
        %>
        <script src="default.js"></script>
</body>
</html>
'use strict';

    function getName() {
        var empNo = document.getElementById("empno").value;
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && xhr.status == 200) {
                document.getElementById("empname").value = xhr.responseText;
            }
        };
        xhr.open("GET", "get_name.asp?empno=" + encodeURIComponent(empNo), true);
        xhr.send();
    }
    
    function toggleEdit(obj){  
        var key_num = obj.dataset.num;
        var input = document.getElementById("bikou_" + key_num);
        var edits = document.getElementById("edit_" + key_num);
        var dels = document.getElementById("delete_" + key_num);
        var tr = document.getElementById("tr_" + key_num);
        if (obj.checked) {
            input.removeAttribute("readonly");
            input.classList.remove("readonly-style");
            tr.classList.add("bg_color");
        } else {
            if (!dels.checked){
                if(!edits.checked){
                    input.setAttribute("readonly", true);
                    input.classList.add("readonly-style");
                    tr.classList.remove("bg_color");
                }
    
            }
        }
    }
    
    function update_value(){
        const checkedValues = Array.from(document.querySelectorAll('input[name="edit_id"]:checked'))
        .map(el => el.value);
        const checkedDelValues = Array.from(document.querySelectorAll('input[name="delete_id"]:checked'))
        .map(el => el.value);
        const checkedNewValues = Array.from(document.querySelectorAll('input[name="id"]'))
        .filter(input => input.value.startsWith("new"));


        let edit_result = [];
        let del_result=[];
        let insert_result = [];

        checkedValues.forEach(value => {
            let input = document.getElementById("bikou_" + value);
            let ker = input.dataset.idn;
            if (input) {
                edit_result.push(ker + "_" + input.value);
            }
        });
        checkedDelValues.forEach(value => {
            let input = document.getElementById("bikou_" + value);
            let ker = input.dataset.idn;
            if (input) {
                del_result.push(ker + "_" + input.value);
            }
        });
        checkedNewValues.forEach(idInput => {
            const row = idInput.closest("tr");
            const id = idInput.value;
            const gkInput = row.querySelector('input[name="gk"]');
            const bikouInput = row.querySelector(`input[name="bikou_${id}"]`);
            const empno = document.getElementById("empno");
            const empname = document.getElementById("empname");

            const gk = gkInput ? gkInput.value : "";
            const bikou = bikouInput ? bikouInput.value : "";
            if(isNaN(gk)){
                alert("数字を入力してね");
                return;
            }

            if (gk !== "" && bikou !== "" && empno.value !== "" && empname.value !== "") {
                insert_result.push(`${empno.value}_${gk}_${bikou}`);
            }
        });

        if(edit_result.length > 0 || del_result.length > 0 || insert_result.length > 0){
            let result = confirm("本当にデータを更新しますか");
            if(result){
                if(edit_result.length > 0){
                    document.getElementById("edit_data").value = edit_result.join("###");
                }
                if(del_result.length > 0){
                    document.getElementById("delete_data").value = del_result.join("###");
                }
                if(insert_result.length > 0){
                    document.getElementById("insert_data").value = insert_result.join("###");
                }
            }
        }
    }
    
    
    function new_recorde_value(){
        event.preventDefault();
        const table = document.querySelector("table");
        if (!table) return;
        
        const rowCount = table.rows.length;
        const newRow = table.insertRow(1); 
        
        // ID, gkの自動仮番号（本来はサーバー採番ですが仮で）
        const newId = "new";

        // 編集チェックボックス
        const editCell = newRow.insertCell(0);
        editCell.innerHTML = `<input type="checkbox" onclick="toggleEdit(this)" checked disabled>`;
        
        // IDセル（readonly）
        const idCell = newRow.insertCell(1);
        idCell.innerHTML = `<input type="text" class="readonly-style" name="id" value="${newId}" readonly>`;
        
        // GKセル（readonly）
        const gkCell = newRow.insertCell(2);
        gkCell.innerHTML = `<input type="text" class="" name="gk" value="" inputmode="numeric" style="ime-mode:disabled;">`;
        
        // 備考入力欄（編集可能）
        const bikouCell = newRow.insertCell(3);
        bikouCell.innerHTML = `<input type="text" name="bikou_${newId}" id="bikou_${newId}" value="">`;
        
        // 削除チェック
        const delCell = newRow.insertCell(4);
        delCell.innerHTML = `<input type="checkbox" disabled>`;
    }

document.addEventListener("DOMContentLoaded", function() {
  document.getElementById("insert").addEventListener("click", new_recorde_value);
});





  </code>
</pre>
  
</body>
</html>



